<?xml version="1.0" encoding="UTF-8"?>
<ViewConfig>
  <Model>
    <DataProvider name="providerOrders" type="hibernateHql">
      <Property name="hql">from Order&#xD;
where 1 = 1&#xD;
#if ($orderDate1)&#xD;
and orderDate >= :orderDate1&#xD;
#end&#xD;
#if ($orderDate2)&#xD;
and orderDate &lt;= :orderDate2&#xD;
#end&#xD;
#if ($customer)&#xD;
and customer.id = :customer.id&#xD;
#end&#xD;
#if ($employee)&#xD;
and employee.id = :employee.id&#xD;
#end&#xD;
</Property>
    </DataProvider>
  </Model>
  <View title="动态HQL查询 ">
    <DataSet id="dsOrders" dataType="[Order]" dataProvider="providerOrders" loadMode="manual" pageSize="10"/>
    <DataSet id="dsCustomers" dataType="[BaseCustomer]" dataProvider="customerInterceptor#findCustomersByCompanyName"/>
    <DataSet id="dsEmployees" dataType="[BaseEmployee]" dataProvider="employeeInterceptor#getAll"/>
    <ToolBar layoutConstraint="top">
      <DataPilot dataSet="dsOrders"/>
      <Separator/>
      <ToolBarButton caption="查询" icon="url(>skin>common/icons.gif) -40px -100px">
        <ClientEvent name="onClick">
var formCondition = this.id(&quot;formCondition&quot;);
var dsOrders = this.id(&quot;dsOrders&quot;);
dsOrders.set(&quot;parameter&quot;, formCondition.get(&quot;entity&quot;));
dsOrders.flushAsync();
</ClientEvent>
      </ToolBarButton>
    </ToolBar>
    <DataSetDropDown id="ddCustomers" dataSet="dsCustomers" dynaFilter="true"/>
    <DataSetDropDown id="ddEmployees" dataSet="dsEmployees"/>
    <AutoForm id="formCondition" layoutConstraint="top" cols="300,300" padding="8" showHint="true">
      <AutoFormElement label="日期（起）" property="orderDate1">
        <Editor>
          <TextEditor dataType="Date"/>
        </Editor>
      </AutoFormElement>
      <AutoFormElement label="日期（至）" property="orderDate2">
        <Editor>
          <TextEditor dataType="Date"/>
        </Editor>
      </AutoFormElement>
      <AutoFormElement label="客户" property="customer" trigger="ddCustomers"/>
      <AutoFormElement label="业务员" property="employee" trigger="ddEmployees"/>
    </AutoForm>
    <DataGrid dataSet="dsOrders" stretchColumnsMode="stretchableColumns"/>
  </View>
</ViewConfig>
