<?xml version="1.0" encoding="UTF-8"?>
<ViewConfig>
  <Arguments/>
  <Context/>
  <Model>
    <DataType name="ExampleCategory" parent="global:ExampleCategory">
      <Reference name="categories" dataProvider="main#getCategories" dataType="[SELF]" parameter="$${this.id}"/>
      <Reference name="examples" dataProvider="main#getExamplesByCategoryId" dataType="[Example]" parameter="$${this.id}"/>
    </DataType>
    <DataType name="Example" parent="global:Example">
      <PropertyDef name="sortFlag" dataType="int"/>
      <PropertyDef name="sources" dataType="[ExampleSource]"/>
    </DataType>
  </Model>
  <View layout="anchor padding:20">
    <DataSet id="dsExamples" dataProvider="main#getCategories" dataType="[ExampleCategory]"/>
    <Action id="actionExecute">
      <ClientEvent name="onExecute">try {&#xD;
    var script = this.get(&quot;#inputScript.text&quot;);&#xD;
    if (!script) {&#xD;
        throw new dorado.Exception(&quot;请先输入或选择一段要测试的脚本！&quot;);&#xD;
    }&#xD;
    &#xD;
    var currentEntity = this.get(&quot;#treeExamples.currentEntity&quot;);&#xD;
    if (!currentEntity) {&#xD;
        throw new dorado.Exception(&quot;请先选中一个树节点！&quot;);&#xD;
    }&#xD;
    &#xD;
    var list = this.get(&quot;#dsExamples.data&quot;);&#xD;
    &#xD;
    eval(script);&#xD;
} &#xD;
catch (e) {&#xD;
    dorado.Exception.processException(e);&#xD;
}&#xD;
</ClientEvent>
      <Property name="icon">url(skin>common/icons.gif) -180px -220px</Property>
      <Property name="caption">运行 (Ctrl+Return)</Property>
      <Property name="hotkey">ctrl+return</Property>
    </Action>
    <SplitPanel>
      <Property name="position">280</Property>
      <Property name="width">800</Property>
      <Property name="height">600</Property>
      <MainControl>
        <SplitPanel>
          <Property name="direction">top</Property>
          <Property name="position">200</Property>
          <MainControl>
            <Panel layout="padding:1">
              <Property name="caption">可选的预设代码</Property>
              <Buttons/>
              <Children>
                <ListBox>
                  <ClientEvent name="onReady">var view = this;&#xD;
$ajax.request(&quot;>dorado/res/com/bstek/dorado/sample/data/UseEntityScripts.js&quot;, function(result) {&#xD;
	self.set(&quot;items&quot;, result.getJsonData());&#xD;
});</ClientEvent>
                  <ClientEvent name="onDataRowClick">this.set(&quot;#inputScript.text&quot;, self.get(&quot;currentItem.script&quot;));&#xD;
self.highlightItem();&#xD;
</ClientEvent>
                  <ClientEvent name="onRenderRow">var script = arg.data.script || &quot;&quot;;&#xD;
if (script.length > 80) script = script.substring(0, 80) + &quot;...&quot;;&#xD;
&#xD;
$(arg.dom).empty().xCreate([&#xD;
	{&#xD;
		tagName: &quot;DIV&quot;,&#xD;
		contentText: arg.data.description,&#xD;
		style: &quot;font-weight: bold; color: navy&quot;&#xD;
	}, {&#xD;
		tagName: &quot;SPAN&quot;,&#xD;
		contentText: script,&#xD;
		style: &quot;color: gray&quot;&#xD;
	}&#xD;
]);&#xD;
</ClientEvent>
                  <Property name="property">description</Property>
                  <Property name="highlightCurrentRow">false</Property>
                  <Property name="rowHeight">45</Property>
                </ListBox>
              </Children>
              <Tools/>
            </Panel>
          </MainControl>
          <SideControl>
            <Panel layout="padding:1">
              <Property name="caption">测试代码</Property>
              <Buttons/>
              <Children>
                <Container>
                  <ToolBar>
                    <ToolBarButton>
                      <Property name="action">actionExecute</Property>
                    </ToolBarButton>
                    <Separator/>
                    <ToolBarButton>
                      <ClientEvent name="onClick">this.get(&quot;#dsExamples&quot;).flushAsync();</ClientEvent>
                      <Property name="caption">还原数据</Property>
                      <Property name="icon">url(skin>common/icons.gif) -280px -220px</Property>
                    </ToolBarButton>
                  </ToolBar>
                  <TextArea id="inputScript">
                    <Property name="blankText">此处可使用3个预设变量：list的值为包含所有根节点数据的EntityList；currentEntity的值为当前选择的树节点所代表的Entityt；dsExamples是数据所在的DataSet。</Property>
                    <Property name="tip">此处可使用两个预设变量：list的值为包含所有根节点数据的EntityList；currentEntity的值为当前选择的树节点所代表的Entity。</Property>
                  </TextArea>
                </Container>
              </Children>
              <Tools/>
            </Panel>
          </SideControl>
        </SplitPanel>
      </MainControl>
      <SideControl>
        <Panel layout="padding:1">
          <Property name="caption">操作的数据</Property>
          <Buttons/>
          <Children>
            <DataTree id="treeExamples">
              <ClientEvent name="onNodeAttached">var node = arg.node, data = node.get(&quot;data&quot;);&#xD;
node.set(&quot;icon&quot;, data.get(&quot;icon&quot;));</ClientEvent>
              <ClientEvent name="onRenderNode">var node = arg.node, data = node.get(&quot;data&quot;);&#xD;
arg.dom.style.fontWeight = (data.get(&quot;hot&quot;) ? &quot;bold&quot; : &quot;&quot;);&#xD;
if (data.get(&quot;new&quot;)) {&#xD;
	$(arg.dom).empty().xCreate([{&#xD;
		tagName: &quot;SPAN&quot;,&#xD;
		contentText: node.get(&quot;label&quot;)&#xD;
	}, {&#xD;
		tagName: &quot;IMG&quot;,&#xD;
		src: $url(&quot;>images/new.gif&quot;),&#xD;
		style: &quot;position: relative; left: 4px; top: 4px&quot;&#xD;
	}]);&#xD;
}&#xD;
else {&#xD;
	arg.processDefault = true;&#xD;
}</ClientEvent>
              <Property name="expandingAnimated">true</Property>
              <Property name="dataSet">dsExamples</Property>
              <BindingConfigs>
                <BindingConfig childrenProperty="categories" icon=">images/folder.gif" labelProperty="label" name="Category" recursive="true">
                  <BindingConfig childrenProperty="examples" icon=">images/file.gif" labelProperty="label" name="Example"/>
                </BindingConfig>
              </BindingConfigs>
            </DataTree>
          </Children>
          <Tools/>
        </Panel>
      </SideControl>
    </SplitPanel>
  </View>
</ViewConfig>
